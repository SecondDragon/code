"use strict";(self.webpackChunkreact_knowledge=self.webpackChunkreact_knowledge||[]).push([[276],{3762:function(e,n,r){var t=r(4165),a=r(5861),c=r(9439),o=r(1413),s=r(7313),l=r(556),i=r(6417);n.Z=function(e){var n=(0,o.Z)({},e),r=n.children,u=n.onClick;delete n.children;var d=(0,s.useState)(!1),f=(0,c.Z)(d,2),p=f[0],h=f[1],v=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,u();case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:h(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return u&&(n.onClick=v),(0,i.jsx)(l.zx,(0,o.Z)((0,o.Z)({},n),{},{loading:p,children:r}))}},6793:function(e,n,r){r.d(n,{Z:function(){return i}});var t=r(9439),a=(r(7313),r(556)),c=r(8467),o=r(2135),s=r(6417),l=function(e){var n=e.title,r=(0,c.s0)(),l=(0,c.TH)(),i=(0,o.lr)(),u=(0,t.Z)(i,1)[0];return(0,s.jsx)(a.l2,{className:"navbar-again-box",onBack:function(){var e=u.get("to");"/login"===l.pathname&&/^\/detail\/\d+$/.test(e)?r(e,{replace:!0}):r(-1)},children:n})};l.defaultProps={title:"\u4e2a\u4eba\u4e2d\u5fc3"};var i=l},2276:function(e,n,r){r.r(n),r.d(n,{default:function(){return x}});var t=r(4165),a=r(5861),c=r(9439),o=r(7313),s=r(556),l=r(6135),i=r(8695),u=r(3762),d=r(6793),f=r(4403),p=r(508),h=r(6417),v={phone:function(e,n){return 0===(n=n.trim()).length?Promise.reject(new Error("\u624b\u673a\u53f7\u662f\u5fc5\u586b\u9879!")):/^(?:(?:\+|00)86)?1\d{10}$/.test(n)?Promise.resolve():Promise.reject(new Error("\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef!"))},code:function(e,n){return 0===(n=n.trim()).length?Promise.reject(new Error("\u9a8c\u8bc1\u7801\u662f\u5fc5\u586b\u9879!")):/^\d{6}$/.test(n)?Promise.resolve():Promise.reject(new Error("\u9a8c\u8bc1\u7801\u683c\u5f0f\u6709\u8bef!"))}},x=(0,l.$j)(null,i.Z.base)((function(e){var n=e.queryUserInfoAsync,r=e.navigate,l=e.usp,i=s.l0.useForm(),x=(0,c.Z)(i,1)[0],Z=(0,o.useState)(!1),m=(0,c.Z)(Z,2),k=m[0],b=m[1],w=(0,o.useState)("\u53d1\u9001\u9a8c\u8bc1\u7801"),j=(0,c.Z)(w,2),g=j[0],I=j[1],y=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var a,c,o,i,u,d,h;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.validateFields();case 3:return a=x.getFieldsValue(),c=a.phone,o=a.code,e.next=6,f.Z.login(c,o);case 6:if(i=e.sent,u=i.code,d=i.token,0===+u){e.next=13;break}return s.FN.show({icon:"fail",content:"\u767b\u5f55\u5931\u8d25"}),x.resetFields(["code"]),e.abrupt("return");case 13:return p.Z.storage.set("tk",d),e.next=16,n();case 16:s.FN.show({icon:"success",content:"\u767b\u5f55/\u6ce8\u518c\u6210\u529f"}),(h=l.get("to"))?r(h,{replace:!0}):r(-1),e.next=23;break;case 21:e.prev=21,e.t0=e.catch(0);case 23:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}(),F=null,P=31,C=function(){if(0===--P)return clearInterval(F),F=null,I("\u53d1\u9001\u9a8c\u8bc1\u7801"),void b(!1);I("".concat(P,"\u79d2\u540e\u91cd\u53d1"))},E=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.validateFields(["phone"]);case 3:return n=x.getFieldValue("phone"),e.next=6,f.Z.sendPhoneCode(n);case 6:if(r=e.sent,0===+r.code){e.next=11;break}return s.FN.show({icon:"fail",content:"\u53d1\u9001\u5931\u8d25"}),e.abrupt("return");case 11:b(!0),C(),F||(F=setInterval(C,1e3)),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){return function(){F&&(clearInterval(F),F=null)}}),[]),(0,h.jsxs)("div",{className:"login-box",children:[(0,h.jsx)(d.Z,{title:"\u767b\u5f55/\u6ce8\u518c"}),(0,h.jsxs)(s.l0,{layout:"horizontal",style:{"--border-top":"none"},footer:(0,h.jsx)(u.Z,{color:"primary",onClick:y,children:"\u63d0\u4ea4"}),form:x,initialValues:{phone:"",code:""},children:[(0,h.jsx)(s.l0.Item,{name:"phone",label:"\u624b\u673a\u53f7",rules:[{validator:v.phone}],children:(0,h.jsx)(s.II,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})}),(0,h.jsx)(s.l0.Item,{name:"code",label:"\u9a8c\u8bc1\u7801",rules:[{validator:v.code}],extra:(0,h.jsx)(u.Z,{size:"small",color:"primary",disabled:k,onClick:E,children:g}),children:(0,h.jsx)(s.II,{})})]})]})}))}}]);